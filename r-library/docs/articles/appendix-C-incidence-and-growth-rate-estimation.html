<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Appendix C - Incidence and growth rate estimation â€¢ jepidemic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Appendix C - Incidence and growth rate estimation">
<meta property="og:description" content="jepidemic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jepidemic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.03</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/appendix-A-validation-methods.html">Appendix A - Reproduction number validation methodology</a>
    </li>
    <li>
      <a href="../articles/appendix-B-cori-method-jepidemic.html">Appendix B - Renewal equation reproduction number estimation and Jepidemic implementation validation</a>
    </li>
    <li>
      <a href="../articles/appendix-C-incidence-and-growth-rate-estimation.html">Appendix C - Incidence and growth rate estimation</a>
    </li>
    <li>
      <a href="../articles/appendix-D-bayesian-estimators.html">Appendix D - Bayesian growth rate and reproduction number estimation</a>
    </li>
    <li>
      <a href="../articles/generating-synthetic-datasets.html">Generating synthetic datasets</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/in-development/bayesian-growth-rate-2.html">Bayesian growth rate estimation</a>
    </li>
    <li>
      <a href="../articles/in-development/proportion-and-growth-rate-estimation.html">Appendix C - Proportions and growth rate estimation</a>
    </li>
    <li>
      <a href="../articles/in-development/two-strain-dynamics.html">Two strain dynamics</a>
    </li>
    <li>
      <a href="../articles/old/cori-method.html">Cori method</a>
    </li>
    <li>
      <a href="../articles/old/epiestim-testing.html">Testing epiestim</a>
    </li>
    <li>
      <a href="../articles/old/growth-rate-estimation.html">Growth rate estimation</a>
    </li>
    <li>
      <a href="../articles/old/growth-rates.html">Cori method</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Appendix C - Incidence and growth rate estimation</h1>
                        <h4 class="author">Rob Challen</h4>
            
            <h4 class="date">28-01-2022</h4>
      
      
      <div class="hidden name"><code>appendix-C-incidence-and-growth-rate-estimation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The effective reproduction number (<span class="math inline">\(R_t\)</span>) is a useful measure of the state of the epidemic but by itself does not inform us of the likely impact that the epidemic will have. To do that we need an unbiased estimator of case counts. As the reproduction number is conditioned on the infectivity profile <span class="math inline">\(\omega\)</span> the timing of the impact of rapidly growing case counts is also not described by the reproduction number. For this a more useful measure is the real-time exponential growth rate (<span class="math inline">\(r_t\)</span>), which it has been argued is more informative for decision making <span class="citation">[@pellisChallengesControlCOVID192021]</span>, as combined with case counts it can inform how quickly cases will reach a particular threshold when intervention is required. The reproduction number implicitly describes a closed population, which when describing sub-populations may be unhelpful. The growth rate does not make such assumptions, can be inferred directly from data and this does not require sophisticated models.</p>
<p>In this appendix we describe the approach to estimation the real-time growth rate adopted throughout the majority of this thesis, and we validate that against synthetic epidemics using the validation methodology described in Appendix A.</p>
</div>
<div id="estimating-incidence-and-growth-rate-" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-incidence-and-growth-rate-" class="anchor"></a>Estimating incidence and growth rate.</h1>
<p>As before, we assume <span class="math inline">\(I_0, I_1, \dots, I_t\)</span> is a time series of infection counts, drawn from some discrete probability distribution with expected value <span class="math inline">\(\overline{I_t}\)</span>. The epidemic growth process is exponential by nature. The real-time growth rate is defined as the rate of change of the logarithm of infections:</p>
<p><span class="math display">\[
\begin{aligned}
\overline{I_{t+\Delta t}} &amp;= \overline{I_{t}}e^{r_t\Delta t} \\
r_t &amp;= \frac{ log(\overline{I_{t+\Delta t}}) - log(\overline{I_{t}})}{\Delta t} \\
r_t &amp;= \frac{d log(\overline{I_t})}{dt} \\
\end{aligned} \tag{eq:littleR}
\]</span></p>
<p>We assume <span class="math inline">\(I_t\)</span> is a Poisson distributed quantity, with a rate parameter which is a function of time:</p>
<p><span class="math display">\[
\begin{aligned}
I_t &amp;\sim Poisson(\lambda_t) \\
\overline{I_t} &amp;= \lambda_t \\
r_t &amp;= \frac{dlog(\lambda_t)}{dt}
\end{aligned}
\]</span></p>
<p>Due to the probability density function underlying the Poisson distribution estimating both <span class="math inline">\(\overline{I_t}\)</span> and <span class="math inline">\(r_t\)</span> from data is straightforward, in a range of frameworks. Following the methods of Loader et al. <span class="citation">[@loaderLocalRegressionLikelihood1999]</span> we represent <span class="math inline">\(\lambda_t\)</span> as a polynomial function of time, and adopt a local maximum likelihood estimator with a logarithmic link function such that:</p>
<p><span class="math display">\[
\begin{aligned}
I = g(y) &amp;= e^{y}\\
y = g^{-1}(I) &amp;= log(I)\\
y_t(t_i) = \langle a, A(t_i-t)\rangle &amp;= a_0 + a_1(t_i-t)+ \dots + a_n(t_i-t)^n\\
l(y,\lambda) &amp;= log(P(y|\lambda))\\
\end{aligned}
\]</span> The global log-likelihood of a set of <span class="math inline">\(\lambda\)</span> estimates <span class="math inline">\(\lambda_0, \lambda_1, \dots, \lambda_n\)</span> is then given by:</p>
<p><span class="math display">\[
\mathcal{L}(\lambda) = \sum_{i=1}^nl(Y_i, \lambda_i)
\]</span></p>
<p>A corresponding localised log-likelihood function evaluated at time <span class="math inline">\(t\)</span> can be created using a local kernel function <span class="math inline">\(w\)</span>.</p>
<p><span class="math display">\[
\mathcal{L}_t(\lambda) = \sum_{i=1}^nw_i(t) .l(Y_i, \langle a, A(t_i-t)\rangle)
\]</span></p>
<p>Which is maximised over the parameter set <span class="math inline">\(a\)</span>, to generate a local estimate of the polynomial. From this direct estimates of the local <span class="math inline">\(\overline{I_t}\)</span> and <span class="math inline">\(r_t\)</span> are given by:</p>
<p><span class="math display">\[
\overline{I_t} = e^{a_0}\\
r_t = \frac{dA}{dt}(t) = a_1
\]</span></p>
<p>The local kernel function is, by default, chosen to be a tri-cube function truncated between -1 and 1 and applied to a window of the data defined by a bandwidth <span class="math inline">\(n\)</span>. Bandwidth selection can be done both as a range of <span class="math inline">\(t-n/2 \dots t+n/2\)</span> entries withing the time series or the nearest <span class="math inline">\(n\)</span> data points:</p>
<p><span class="math display">\[
w_i(u) = \Big(1-\Big|\frac{i-u}{n}\Big|^3\Big)^3
\]</span></p>
<p>Using this method, the incidence and growth rate estimation therefore depend on the bandwidth and the polynomial degree. Given that the most interesting part of the data is the right hand boundary, the choice of bandwidth selection method also is important, as this influences behaviour at this boundary.</p>
<p>The confidence of the estimates of <span class="math inline">\(a\)</span>, given the logarithmic transformation are described in detail in Loader et al. <span class="citation">[@loaderLocalRegressionLikelihood1999]</span> and less straightforward. The confidence estimates of predictions rely on a variance stabilizing link function, and a local regression weight diagram, and an assumption of normality in the transformed space, however the derivation of the confidence intervals on the parameters themselves is not fully detailed. As such an emiprical assessment of calibration and precision of growth rate estimates is warranted.</p>
</div>
<div id="estimating-r_t-from-the-growth-rate-" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-r_t-from-the-growth-rate-" class="anchor"></a>Estimating <span class="math inline">\(R_t\)</span> from the growth rate.</h1>
<p>With an estimate of the growth rate available we would like to be able to make an estimate of the reproduction number, derived from this growth rate. We adopt the method of Wallinga et al. (2007) <span class="citation">[@wallingaHowGenerationIntervals2007]</span>. This describes the generation interval distribution <span class="math inline">\(g(a)\)</span> as a continuous function which describes the probability of a secondary infection related to the "age" <span class="math inline">\(a\)</span> of a primary infection, i.e. the time from primary to secondary infection. This is combined with the Lotka-Euler equation <span class="citation">[@andersonInfectiousDiseasesHumans1992; @coaleGrowthStructureHuman1972; @dublinTrueRateNatural1925; @fellerIntegralEquationRenewal1941]</span> to generate the following relationship between <span class="math inline">\(R\)</span> and <span class="math inline">\(r\)</span></p>
<p><span class="math display">\[
\frac{1}{R} = \int_{a=0}^{\infty}e^{-ra}g(a)da
\]</span></p>
<p>Which is identifiable as the Laplace transformation of <span class="math inline">\(g(a)\)</span> and hence the moment generating function <span class="math inline">\(M\)</span> of the distribution <span class="math inline">\(g()\)</span>. This leads to the following simplified relationship:</p>
<p><span class="math display">\[
R = \frac{1}{M(-r)}
\tag{eq:momgen}
\]</span></p>
<p>This relationship can be used to connect <span class="math inline">\(R\)</span> with <span class="math inline">\(r\)</span> for any given generation interval distribution assuming a moment generating function exists. In practice, as infection duration is measured in whole days, and in the implementation of the renewal equation method for estimating <span class="math inline">\(R_t\)</span> <span class="citation">[@coriEpiEstimEstimateTime2021; @thompsonImprovedInferenceTimevarying2019]</span> the discrete version of the generation interval distribution is used and referred to as the infectivity profile (<span class="math inline">\(\omega_1, \omega_2, \dots, \omega_a\)</span>).</p>
<p>The discrete version of the relationship in <span class="math inline">\(\eqref{eq:momgen}\)</span> is derived in Wallinga et al. (2007) <span class="citation">[@wallingaHowGenerationIntervals2007]</span> and given as:</p>
<p><span class="math display">\[
R = \frac{r}{
  \sum_{i=1}^n
  \omega_i \frac{
    e^{-ra_{i-1}}-e^{-ra_{i}}
  }{
    a_i-a_{i-1}
  }
}
\tag{eq:disc}
\]</span> Where <span class="math inline">\(a_i\)</span> is the upper boundary of the discretisation and <span class="math inline">\(a_{i-1}\)</span> is the lower bound such that:</p>
<p><span class="math display">\[
\omega_i = \int_{a_{i-1}}^{a_i}g(a)da
\]</span></p>
<p>This allows for arbitrary discretisation intervals. In the renewal equation method, however, the discretisation of <span class="math inline">\(\omega\)</span> is enforced to be on whole day boundaries such that <span class="math inline">\(a_0 = 0, a_1 = 1, \dots\)</span>. This simplifies <span class="math inline">\(\eqref{eq:disc}\)</span> to:</p>
<p><span class="math display">\[
R = \frac{r}{
  \sum_{i=1}^n
  \omega_i (e^{-r(i-1)}-e^{-ri})
}
\]</span></p>
<p>With our estimates of the growth rate from the first section, and their associated quantiles, we can combine this method with a sampling approach to generate an alternative estimate for the quantiles of the reproduction number.</p>
</div>
<div id="implementation" class="section level1">
<h1 class="hasAnchor">
<a href="#implementation" class="anchor"></a>Implementation</h1>
<p>The growth rate algorithm described is simply implemented using the R library locfit <span class="citation">[@loaderLocfitLocalRegression2020]</span> which provides built in local likelihood estimators for Poisson distributed count variables, using a logarithmic link function, and can directly estimate incidence and the derivatives of the log-transformed incidence data, which provides us with a direct estimate of the growth rate. This can also be used to calculate a first derivative of growth. By fitting a Quasi-Poisson model rather than a direct Poisson model we can account for over-dispersion of the real life incidence data, and as an aside we can obtain a time varying estimate of the degree of dispersion.</p>
<p>The key parameterisation of the local likelihood estimate depend on a polynomial degree, and the kernel bandwidth. As we are applying to a time-series we express the band-width in terms of a time window size, in the unit of days. The algorithm is implemented in a R package called "jepidemic", which is open source and available on GitHub <span class="citation">[@rob_challen_2022_5820292]</span>.</p>
</div>
<div id="growth-rate-validation" class="section level1">
<h1 class="hasAnchor">
<a href="#growth-rate-validation" class="anchor"></a>Growth rate validation</h1>
<p>In this section we compare the performance of the growth rate estimator with a selection of parameterisations, involving linear or quadratic local polynomials fitted to either data included within a bandwidth of 14 or 21 days, against synthetic data with known growth rates. This follows the methodology described in Appendix A, with minor configuration changes to adjust for the fact the estimates of growth rate have a threshold value of 0, where the epidemic transitions from growth to decline, rather than the threshold value of 1 for the reproduction number.</p>
<p>In Figure C1 we see qualitative estimates of the growth rate estimates against simulated for a range of configurations. In general the growth rate estimates appear robust, but as may be expected more accurate if the growth rate is a smoothly varying quantity rather than a discontinuous function. Polynomial degree does not have an obvious effect except at the boundaries of the time series, which the quadratics remain accurate up to the end of the time-series, whereas the linear fit appear less so.</p>
<p><img src="../../../../../../home/terminological/Dropbox/sarscov2/r-estimation-methodology/qualitative-locfit-growth-2022-01-28.png" width="885"></p>
<p><em>Figure C1: qualitative estimates of growth rate (black) against simulated (red) comparing 4 configurations of the locally fitted polynomial method that vary in the parameterisation of the polynomial degree and the bandwidth</em></p>
<p>From figure C1 there is no obvious delay to the growth rate estimates, and this is borne out quantitatively by the lag analysis in Figure C2 which shows all methods to have the same degree of delay at 0.5 days. This specific amount of delay is possibly introduced as a result of treating discrete daily count data as if it is continuous in time.</p>
<p><img src="../../../../../../home/terminological/Dropbox/sarscov2/r-estimation-methodology/lag-locfit-growth-2022-01-28.png" width="885"></p>
<p><em>Figure C2: time delay analysis of growth rate (black) against simulated (red) comparing 4 configurations of the locally fitted polynomial method that vary in the parameterisation of the polynomial degree and the bandwidth</em></p>
<p>A quantitative analysis of the quality of the growth rate estimates is shown in Figure C3 and Table C1. These show the estimators are all unbiased. Those with shorter windows are better calibrated (Panel B), and less frequently predict growth when the epidemic is declining that those with longer windows (Panel E) although the frequency of this is very low in all estimators. Overall the estimators with the longer windows appear to marginally over precise (with a positive quantile deviation in Table C1 and I shaped quantile density plots in Panel C). However the CPRS score, as an overall measure combining accuracy and precision, is best (lowest) for the quadratic polynomial fitted over a longer time window.</p>
<p><img src="../../../../../../home/terminological/Dropbox/sarscov2/r-estimation-methodology/error-summary-locfit-growth-2022-01-28.png" width="885"></p>
<p><em>Figure C3: Estimate quality metric summaries for multiple estimation methods. In this instance we compare the performance of the growth rate estimators that vary in the parameterisation of the polynomial degree and the bandwidth. Panel A show summary statistics for the bias of <span class="math inline">\(R_t\)</span> estimates, panel B shows the calibration. Panel C shows the quantile density, panel D the CRPS and panel E the critical threshold calibration.</em></p>
<p><em>Table C1: summary of quantitative analysis of growth rate (black) against simulated (red) comparing 4 configurations of the locally fitted polynomial method that vary in the parameterisation of the polynomial degree and the bandwidth</em></p>
<p><img src="../../../../../../home/terminological/Dropbox/sarscov2/r-estimation-methodology/error-summary-locfit-growth-table-2022-01-28.png" width="885"></p>
<p>There is a hint in figure C2 that the behaviour at the boundaries may be different and therefore a full breakdown of the validation metrics by the scenario is shown in Figure C4. The boundary effect, which is most obvious for the estimators relying on degree 1 polynomials is observed clearly in panels D, and P.</p>
<p><img src="../../../../../../home/terminological/Dropbox/sarscov2/r-estimation-methodology/error-breakdown-locfit-growth-2022-01-28.png" width="885"></p>
<p><em>Figure C4: Estimate quality metric intermediate detail and model comparison. Panel A-D show summary statistics for the bias of growth rate estimates broken down by the simulation smoothness, weekly variability, initial incidence, and time series boundary status. Panels E-F shows the calibration for the same subdivisions. Panels I-L shows the quantile density, panel M-P the CRPS, and panel Q-T the critical thresholds for the same subdivisions.</em></p>
<p>Overall all the estimators perform well. There is weak evidence that the estimators with polynomial degree 2 are better than the others, and particularly if the window is longer, however the longer windows do tend to reduce the calibration and result in over-precise estimates. As a balanced default we therefore generally select a polynomial degree of 2 with a 14 day window.</p>
</div>
<div id="r_t-validation" class="section level1">
<h1 class="hasAnchor">
<a href="#r_t-validation" class="anchor"></a><span class="math inline">\(R_t\)</span> validation</h1>
<p>The method for conversion of growth rate to <span class="math inline">\(R_t\)</span> described above can be combined with these growth rate estimates. Uncertainty is propagated by samping values from the growth rate estimate distribution and as a result is somewhat slow and non-deterministic. It however forms a useful comparison to the <span class="math inline">\(R_t\)</span> estimation methods presented in Appendix B.</p>
<p>Qualitatively the derived <span class="math inline">\(R_t\)</span> estimates are shown in Figure C5. The growth rate based methods seem comparable but with less uncertainty than the renewal equation based method.</p>
<p><img src="../../../../../../home/terminological/Dropbox/sarscov2/r-estimation-methodology/qualitative-locfit-rt-2022-01-28.png" width="885"></p>
<p><em>Figure C5: qualitative estimates of <span class="math inline">\(R_t\)</span> (black) against simulated (red) comparing 2 configurations of the growth rate based <span class="math inline">\(R_t\)</span> estimators using methods presented here and varying by time window (14 or 21 days) with the best performing renewal equation method from Appendix B (labelled "Improved renewal eqn").</em></p>
<p>As the Wallinga et al (2007) <span class="citation">[@wallingaHowGenerationIntervals2007]</span> method is also used to generate the simulated values of <span class="math inline">\(R_t\)</span> from simulated growth rates, it is unsurprising that the growth rate based methods produce estimates with minimal lag, compared to those based on the renewal equation method, as Figure C6 shows, because the true value of the reproduction number is a different type of reproduction number to the instantaneous reproduction number produced by the renewal equation methods presented here.</p>
<p><img src="../../../../../../home/terminological/Dropbox/sarscov2/r-estimation-methodology/lag-locfit-rt-2022-01-28.png" width="885"></p>
<p><em>Figure C6: time delay analysis of <span class="math inline">\(R_t\)</span> (black) against simulated (red) comparing 2 configurations of the growth rate based <span class="math inline">\(R_t\)</span> estimators using methods presented here and varying by time window (14 or 21 days) with the best performing renewal equation method from Appendix B (labelled "Improved renewal eqn").</em></p>
<p>As previously the quantitative comparison shown in Figure C7 and Table C2 the growth rate based methods. This shows that the growth rate based methods are accurate but somewhat over precise. The overall CPRS metric shows the best performing estimate is the growth rate based estimator however this is offset by their generally lower calibration, and over-precision.</p>
<p><img src="../../../../../../home/terminological/Dropbox/sarscov2/r-estimation-methodology/error-summary-locfit-rt-2022-01-28.png" width="885"></p>
<p><em>Figure C7: Estimate quality metric summaries for multiple estimation methods. In this instance we compare the performance of the growth rate estimators that vary in the parameterisation of the polynomial degree and the bandwidth. Panel A show summary statistics for the bias of <span class="math inline">\(R_t\)</span> estimates, panel B shows the calibration. Panel C shows the quantile density, panel D the CRPS and panel E the critical threshold calibration.</em></p>
<p><em>Table C2: summary of quantitative analysis of <span class="math inline">\(R_t\)</span> (black) against simulated (red) comparing 3 methods that vary in their prior selection process</em></p>
<pre><code>#&gt; Error in abs_path(input): The file 'appendix-C-incidence-and-growth-rate-estimation.Rmd' does not exist.</code></pre>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>In this appendix we present our chosen method for estimating the real-time growth rate of an exponentially growing epidemic, by local likelihood estimation of a Poisson model with a time varying polynomial as the rate parameter. This is shown to be robust to a range of different synthetic scenarios with known growth rate. Configured to use a quadratic and a local window of 14 days produces a estimate that balances general performance with calibration. Translating this growth rate estimate into a reproduction number produces an accurate estimate of the reproduction number, although the same methodology is used for calculating the true value of the reproduction number as the estimate. The resulting estimate of the reproduction number is also over precise and comparatively slow to calculate so is not felt to be a significant improvement over the best performing renewal equation method described in Appendix B. One advantage to note though is that due to the fact that the growth rate estimate can be made right up to the end of the time series without any delay being introduced, the derived estimates of the reproduction number are potentially more up to date than those derived from the renewal equation method.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs">

</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Rob Challen, terminological.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
